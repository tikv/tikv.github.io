<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="generator" content="rustdoc"><meta name="description" content="Batches of multiple writes that are committed atomically"><meta name="keywords" content="rust, rustlang, rust-lang, WriteBatch"><title>engine_traits::write_batch::WriteBatch - Rust</title><link rel="stylesheet" type="text/css" href="../../normalize.css"><link rel="stylesheet" type="text/css" href="../../rustdoc.css" id="mainThemeStyle"><link rel="stylesheet" type="text/css" href="../../light.css"  id="themeStyle"><link rel="stylesheet" type="text/css" href="../../dark.css" disabled ><link rel="stylesheet" type="text/css" href="../../ayu.css" disabled ><script id="default-settings"></script><script src="../../storage.js"></script><script src="../../crates.js"></script><noscript><link rel="stylesheet" href="../../noscript.css"></noscript><link rel="icon" type="image/svg+xml" href="../../favicon.svg">
<link rel="alternate icon" type="image/png" href="../../favicon-16x16.png">
<link rel="alternate icon" type="image/png" href="../../favicon-32x32.png"><style type="text/css">#crate-search{background-image:url("../../down-arrow.svg");}</style></head><body class="rustdoc trait"><!--[if lte IE 8]><div class="warning">This old browser is unsupported and will most likely display funky things.</div><![endif]--><nav class="sidebar"><div class="sidebar-menu" role="button">&#9776;</div><a href='../../engine_traits/index.html'><div class='logo-container rust-logo'><img src='../../rust-logo.png' alt='logo'></div></a><p class="location">Trait WriteBatch</p><div class="sidebar-elems"><div class="block items"><a class="sidebar-title" href="#required-methods">Required Methods</a><div class="sidebar-links"><a href="#tymethod.clear">clear</a><a href="#tymethod.count">count</a><a href="#tymethod.data_size">data_size</a><a href="#tymethod.is_empty">is_empty</a><a href="#tymethod.pop_save_point">pop_save_point</a><a href="#tymethod.rollback_to_save_point">rollback_to_save_point</a><a href="#tymethod.set_save_point">set_save_point</a><a href="#tymethod.should_write_to_engine">should_write_to_engine</a><a href="#tymethod.with_capacity">with_capacity</a><a href="#tymethod.write_opt">write_opt</a></div><a class="sidebar-title" href="#provided-methods">Provided Methods</a><div class="sidebar-links"><a href="#method.write">write</a></div><a class="sidebar-title" href="#implementors">Implementors</a></div><p class="location"><a href="../index.html">engine_traits</a>::<wbr><a href="index.html">write_batch</a></p><div id="sidebar-vars" data-name="WriteBatch" data-ty="trait" data-relpath=""></div><script defer src="sidebar-items.js"></script></div></nav><div class="theme-picker"><button id="theme-picker" aria-label="Pick another theme!" aria-haspopup="menu"><img src="../../brush.svg" width="18" height="18" alt="Pick another theme!"></button><div id="theme-choices" role="menu"></div></div><nav class="sub"><form class="search-form"><div class="search-container"><div><select id="crate-search"><option value="All crates">All crates</option></select><input class="search-input" name="search" disabled autocomplete="off" spellcheck="false" placeholder="Click or press ‘S’ to search, ‘?’ for more options…" type="search"></div><button type="button" class="help-button">?</button>
                <a id="settings-menu" href="../../settings.html"><img src="../../wheel.svg" width="18" height="18" alt="Change settings"></a></div></form></nav><section id="main" class="content"><h1 class="fqn"><span class="in-band">Trait <a href="../index.html">engine_traits</a>::<wbr><a href="index.html">write_batch</a>::<wbr><a class="trait" href="">WriteBatch</a><button id="copy-path" onclick="copy_path(this)">⎘</button></span><span class="out-of-band"><span id="render-detail"><a id="toggle-all-docs" href="javascript:void(0)" title="collapse all docs">[<span class="inner">&#x2212;</span>]</a></span><a class="srclink" href="../../src/engine_traits/write_batch.rs.html#82-129" title="goto source code">[src]</a></span></h1><div class="docblock type-decl hidden-by-usual-hider"><pre class="rust trait">pub trait WriteBatch&lt;E:&nbsp;<a class="trait" href="../../engine_traits/write_batch/trait.WriteBatchExt.html" title="trait engine_traits::write_batch::WriteBatchExt">WriteBatchExt</a> + <a class="trait" href="https://doc.rust-lang.org/nightly/core/marker/trait.Sized.html" title="trait core::marker::Sized">Sized</a>&gt;: <a class="trait" href="../../engine_traits/write_batch/trait.Mutable.html" title="trait engine_traits::write_batch::Mutable">Mutable</a> {
    fn <a href="#tymethod.with_capacity" class="fnname">with_capacity</a>(e: <a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.reference.html">&amp;</a>E, cap: <a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.usize.html">usize</a>) -&gt; Self;
<div class="item-spacer"></div>    fn <a href="#tymethod.write_opt" class="fnname">write_opt</a>(&amp;self, opts: &amp;<a class="struct" href="../../engine_traits/options/struct.WriteOptions.html" title="struct engine_traits::options::WriteOptions">WriteOptions</a>) -&gt; <a class="type" href="../../engine_traits/errors/type.Result.html" title="type engine_traits::errors::Result">Result</a>&lt;<a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.unit.html">()</a>&gt;;
<div class="item-spacer"></div>    fn <a href="#tymethod.data_size" class="fnname">data_size</a>(&amp;self) -&gt; <a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.usize.html">usize</a>;
<div class="item-spacer"></div>    fn <a href="#tymethod.count" class="fnname">count</a>(&amp;self) -&gt; <a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.usize.html">usize</a>;
<div class="item-spacer"></div>    fn <a href="#tymethod.is_empty" class="fnname">is_empty</a>(&amp;self) -&gt; <a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.bool.html">bool</a>;
<div class="item-spacer"></div>    fn <a href="#tymethod.should_write_to_engine" class="fnname">should_write_to_engine</a>(&amp;self) -&gt; <a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.bool.html">bool</a>;
<div class="item-spacer"></div>    fn <a href="#tymethod.clear" class="fnname">clear</a>(&amp;mut self);
<div class="item-spacer"></div>    fn <a href="#tymethod.set_save_point" class="fnname">set_save_point</a>(&amp;mut self);
<div class="item-spacer"></div>    fn <a href="#tymethod.pop_save_point" class="fnname">pop_save_point</a>(&amp;mut self) -&gt; <a class="type" href="../../engine_traits/errors/type.Result.html" title="type engine_traits::errors::Result">Result</a>&lt;<a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.unit.html">()</a>&gt;;
<div class="item-spacer"></div>    fn <a href="#tymethod.rollback_to_save_point" class="fnname">rollback_to_save_point</a>(&amp;mut self) -&gt; <a class="type" href="../../engine_traits/errors/type.Result.html" title="type engine_traits::errors::Result">Result</a>&lt;<a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.unit.html">()</a>&gt;;

    fn <a href="#method.write" class="fnname">write</a>(&amp;self) -&gt; <a class="type" href="../../engine_traits/errors/type.Result.html" title="type engine_traits::errors::Result">Result</a>&lt;<a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.unit.html">()</a>&gt; { ... }
}</pre></div><div class="docblock"><p>Batches of multiple writes that are committed atomically</p>
<p>Each write batch consists of a series of commands: put, delete
delete_range, and their column-family-specific equivalents.</p>
<p>Because write batches are atomic, once written to disk all their effects are
visible as if all other writes in the system were written either before or
after the batch. This includes range deletes.</p>
<p>The exact strategy used by WriteBatch is up to the implementation.
RocksDB though <em>seems</em> to serialize the writes to an in-memory buffer,
and then write the whole serialized batch to disk at once.</p>
<p>Write batches may be reused after being written. In that case they write
exactly the same data as previously, Replacing any keys that may have
changed in between the two batch writes.</p>
<p>Commands issued to write batches can be rolled back prior to being committed
by use of <em>save points</em>. At any point in the life of a write batch a save
point can be recorded. Any number of save points can be recorded to a stack.
Calling <code>rollback_to_save_point</code> reverts all commands issued since the last
save point, and pops the save point from the stack.</p>
</div><h2 id="required-methods" class="small-section-header">Required methods<a href="#required-methods" class="anchor"></a></h2><div class="methods"><h3 id="tymethod.with_capacity" class="method"><code>fn <a href="#tymethod.with_capacity" class="fnname">with_capacity</a>(e: <a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.reference.html">&amp;</a>E, cap: <a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.usize.html">usize</a>) -&gt; Self</code><a class="srclink" href="../../src/engine_traits/write_batch.rs.html#84" title="goto source code">[src]</a></h3><div class="docblock"><p>Create a WriteBatch with a given command capacity</p>
</div><h3 id="tymethod.write_opt" class="method"><code>fn <a href="#tymethod.write_opt" class="fnname">write_opt</a>(&amp;self, opts: &amp;<a class="struct" href="../../engine_traits/options/struct.WriteOptions.html" title="struct engine_traits::options::WriteOptions">WriteOptions</a>) -&gt; <a class="type" href="../../engine_traits/errors/type.Result.html" title="type engine_traits::errors::Result">Result</a>&lt;<a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.unit.html">()</a>&gt;</code><a class="srclink" href="../../src/engine_traits/write_batch.rs.html#87" title="goto source code">[src]</a></h3><div class="docblock"><p>Commit the WriteBatch to disk with the given options</p>
</div><h3 id="tymethod.data_size" class="method"><code>fn <a href="#tymethod.data_size" class="fnname">data_size</a>(&amp;self) -&gt; <a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.usize.html">usize</a></code><a class="srclink" href="../../src/engine_traits/write_batch.rs.html#99" title="goto source code">[src]</a></h3><div class="docblock"><p>The data size of a write batch</p>
<p>This is necessarily engine-dependent. In RocksDB though it appears to
represent the byte length of all write commands in the batch, as
serialized in memory, prior to being written to disk.</p>
</div><h3 id="tymethod.count" class="method"><code>fn <a href="#tymethod.count" class="fnname">count</a>(&amp;self) -&gt; <a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.usize.html">usize</a></code><a class="srclink" href="../../src/engine_traits/write_batch.rs.html#102" title="goto source code">[src]</a></h3><div class="docblock"><p>The number of commands in this batch</p>
</div><h3 id="tymethod.is_empty" class="method"><code>fn <a href="#tymethod.is_empty" class="fnname">is_empty</a>(&amp;self) -&gt; <a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.bool.html">bool</a></code><a class="srclink" href="../../src/engine_traits/write_batch.rs.html#105" title="goto source code">[src]</a></h3><div class="docblock"><p>Whether any commands have been issued to this batch</p>
</div><h3 id="tymethod.should_write_to_engine" class="method"><code>fn <a href="#tymethod.should_write_to_engine" class="fnname">should_write_to_engine</a>(&amp;self) -&gt; <a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.bool.html">bool</a></code><a class="srclink" href="../../src/engine_traits/write_batch.rs.html#110" title="goto source code">[src]</a></h3><div class="docblock"><p>Whether the number of commands exceeds WRITE_BATCH_MAX_KEYS</p>
<p>If so, the <code>write</code> method should be called.</p>
</div><h3 id="tymethod.clear" class="method"><code>fn <a href="#tymethod.clear" class="fnname">clear</a>(&amp;mut self)</code><a class="srclink" href="../../src/engine_traits/write_batch.rs.html#115" title="goto source code">[src]</a></h3><div class="docblock"><p>Clears the WriteBatch of all commands</p>
<p>It may be reused afterward as an empty batch.</p>
</div><h3 id="tymethod.set_save_point" class="method"><code>fn <a href="#tymethod.set_save_point" class="fnname">set_save_point</a>(&amp;mut self)</code><a class="srclink" href="../../src/engine_traits/write_batch.rs.html#118" title="goto source code">[src]</a></h3><div class="docblock"><p>Push a save point onto the save point stack</p>
</div><h3 id="tymethod.pop_save_point" class="method"><code>fn <a href="#tymethod.pop_save_point" class="fnname">pop_save_point</a>(&amp;mut self) -&gt; <a class="type" href="../../engine_traits/errors/type.Result.html" title="type engine_traits::errors::Result">Result</a>&lt;<a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.unit.html">()</a>&gt;</code><a class="srclink" href="../../src/engine_traits/write_batch.rs.html#123" title="goto source code">[src]</a></h3><div class="docblock"><p>Pop a save point from the save point stack</p>
<p>This has no effect on the commands already issued to the write batch</p>
</div><h3 id="tymethod.rollback_to_save_point" class="method"><code>fn <a href="#tymethod.rollback_to_save_point" class="fnname">rollback_to_save_point</a>(&amp;mut self) -&gt; <a class="type" href="../../engine_traits/errors/type.Result.html" title="type engine_traits::errors::Result">Result</a>&lt;<a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.unit.html">()</a>&gt;</code><a class="srclink" href="../../src/engine_traits/write_batch.rs.html#128" title="goto source code">[src]</a></h3><div class="docblock"><p>Revert all commands issued since the last save point</p>
<p>Additionally pops the last save point from the save point stack.</p>
</div></div><span class="loading-content">Loading content...</span><h2 id="provided-methods" class="small-section-header">Provided methods<a href="#provided-methods" class="anchor"></a></h2><div class="methods"><h3 id="method.write" class="method"><code>fn <a href="#method.write" class="fnname">write</a>(&amp;self) -&gt; <a class="type" href="../../engine_traits/errors/type.Result.html" title="type engine_traits::errors::Result">Result</a>&lt;<a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.unit.html">()</a>&gt;</code><a class="srclink" href="../../src/engine_traits/write_batch.rs.html#90-92" title="goto source code">[src]</a></h3><div class="docblock"><p>Commit the WriteBatch to disk atomically</p>
</div></div><span class="loading-content">Loading content...</span><h2 id="implementors" class="small-section-header">Implementors<a href="#implementors" class="anchor"></a></h2><div class="item-list" id="implementors-list"></div><span class="loading-content">Loading content...</span><script type="text/javascript" src="../../implementors/engine_traits/write_batch/trait.WriteBatch.js" async></script></section><section id="search" class="content hidden"></section><section class="footer"></section><div id="rustdoc-vars" data-root-path="../../" data-current-crate="engine_traits" data-search-js="../../search-index.js"></div>
    <script src="../../main.js"></script></body></html>